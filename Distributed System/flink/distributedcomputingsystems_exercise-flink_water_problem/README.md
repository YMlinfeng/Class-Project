# Water Problem

## 待完成:

* 请在DSPPCode.flink.water_problem.impl中创建WaterProblemImpl， 继承WaterProblem， 实现抽象方法。
  可以参考[基于 DataStream API 实现欺诈检测](https://ci.apache.org/projects/flink/flink-docs-release-1.13/zh/docs/try-flink/datastream/)

## 题目描述:

* 有若干个泳池，每个泳池各有一条管道与外界相连。 管道中有水流通过，引起泳池水位线高度的变化。

  假设泳池最初是空的，水位可以无限高。

  泳池管理员时常调节管道中水流的速度，来控制泳池的水位线高度，管理员也时常查看泳池的具体水位线高度。

  现给出一个包含操作事件和查询事件的流， 请输出每次查询时对应的泳池的水位。

* 输入:

  输入数据的格式为(isQuery,poolId,timestamp,speed)。 

  isQuery的取值是true或者false，如果是true请输出水位线高度，如果是false请修改水流速度。

  poolId是一个整数，取值范围是[0,10]，表示查询或者修改的那个泳池的编号。  

  timestamp是一个整数，取值范围是[0,2000]，表示查询或者修改事件发生的时刻，输入数据保证timestamp是非降序的。  

  speed是一个整数，取值在int范围内。如果isQuery是false，表示把对应泳池管道的速度修改到speed；如果isQuery是true，请忽略这个字段。

  ```
  false,1,0,10
  false,2,0,20
  true,1,5,0
  true,2,5,0
  false,1,10,100
  false,2,10,0
  true,1,20,0
  true,2,20,0
  ```

* 输出:

  对每次查询事件请输出当时对应泳池的水位，输出格式为(poolId,timestamp,watermark)。

  ```
  1,5,50
  2,5,100
  1,20,1100
  2,20,200
  ```
  
* 样例解释

  在t=0时，把1号泳池的流速修改到10，把2号泳池的流速修改到20。 

  在t=5时，查询1号和2号泳池的水位。此时，1号泳池的水位是 `10*5=50` ，2号泳池的水位是
  `20*5=100` ，所以输出(1,5,50)和(2,5,100)。

  在t=10时，把1号泳池的流速修改到100，把2号泳池的流速修改到0。 

  在t=20时，查询1号和2号泳池的水位。此时，1号泳池的水位是 `10*10+100*10=1100` ，2号泳池的水位是
  `20*10+0*10=200` ，所以输出(1,20,1100)和(2,20,200)。